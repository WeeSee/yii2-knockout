function viewmodelBase(){var t=this;this.options={},this.setOptions=function(o){t.options=o},this.errors=ko.observableArray([]),this.hasError=ko.computed(function(){return this.errors.length>0},this),this.hasErrors=this.hasError,this.logOptions=function(){console.log(t.options)},this.get=function(){var o={};return t._attributes&&t._attributes.length>0?$.each(t._attributes,function(r,i){ko.isWriteableObservable(t[i])&&(o[i]=t[i].get?t[i].get():t[i]())}):$.each(t,function(r){ko.isWriteableObservable(t[r])&&(o[r]=t[r]())}),o},this.getModel=function(){var o={};return o[t._name]=t.get(),o},this._isSetting=ko.observable(!1),this.set=function(o,r){r=r||{},t._isSetting(!0),t._attributes?$.each(t._attributes,function(i,e){var n=t[e];d=o?o[e]:null,ko.isWriteableObservable(n)&&(n.set?n.set(d,r[e]):n(d),n.errors?n.errors([]):null,n.validated?n.validated(!1):null)}):$.each(o,function(o,r){var i=t[o];ko.isWriteableObservable(i)&&(i.set?i.set(r):i(r),i.errors?i.errors([]):null,i.validated?i.validated(!1):null)});var i=[];return $.each(r,function(o,r){var e=t[o];e&&e.errors?(e.errors(r),i.concat(r)):e||console.log("setting undefined: ",o)}),t.errors(i),t._isSetting(!1),t},this.modal=function(o){t.options.modal&&$("#"+t.options.modal).modal(o)},this.update=function(o){t.options.url&&t.post(t.options.url,t.getModel(),function(r){if(t.options.grid&&baseViewModel.pjax(t.options.grid),r.errors&&0==r.errors.length||!r.errors){t.modal("hide");var i=!0;o&&(i=o(r)||!0),i&&t.options.redirect&&(window.location.href=t.options.redirect)}})},this.post=function(o,r,i){var e={};t.classname?e[t.classname]=r:e=r;var n=$.post(o,e,function(o){t.set(o.model,o.errors),i&&i(o)},"json");console.log("post return",n)},this.formSubmit=function(){t.options.form&&(console.log("capturing form submit",t.options.form),$("#"+t.options.form).on("submit",function(o){return o.preventDefault(),console.log("captured form submit"),t.update(),!1}))},this.finish=function(){t.isValid=ko.computed(function(){if(!this._validators)return!0;var t=this,o=!0;return $.each(this._validators,function(r,i){t[i].hasError&&t[i].hasError()&&(o=!1)}),o},t),t.formSubmit()},this.validate=function(){$.each(t._validators,function(o,r){var i=t[r];i.validated&&1!=i.validated()&&i.validate&&i.validate()}),$.each(t._lists,function(o,r){var i=t[r];i.validate&&i.validate()})}}ko.observableArray.fn.toString=function(){return"KO.ARRAY: "+ko.toJSON(this(),null,2)},ko.observableArray.fn.isObservableArray=!0,ko.observable.fn.toString=function(){return"KO.OBSERVABLE: "+ko.toJSON(this(),null,2)},ko.computed.fn.toString=function(){return"KO.COMPUTED: "+ko.toJSON(this(),null,2)};